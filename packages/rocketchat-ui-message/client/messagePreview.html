<template name="messagePreview">
	<li id="{{_id}}" data-context={{actionContext}} class="message background-transparent-dark-hover {{system}} {{t}} {{own}} {{isTemp}} {{chatops}} {{customClass}}" data-username="{{u.username}}" data-date="{{date}}" data-timestamp="{{timestamp}}">
		{{#if avatar}}
			{{#if avatarFromUsername}}
				<button class="thumb user-card-message" data-username="{{u.username}}" tabindex="1">{{> avatar username=avatarFromUsername}}</button>
			{{else}}
				<button class="thumb user-card-message" data-username="{{u.username}}" tabindex="1">
					<div class="avatar">
						<!-- <div class="avatar-image" style="background-image:url({{encodeURI avatar}})"></div> -->
					</div>
				</button>
			{{/if}}
		{{else}}
			{{#if emoji}}
				<button class="thumb user-card-message" data-username="{{u.username}}" tabindex="1">
					<div class="avatar">
						{{{getEmoji emoji}}}
					</div>
				</button>
			{{else}}
				<button class="thumb user-card-message" data-username="{{u.username}}" tabindex="1">{{> avatar username=u.username}}</button>
			{{/if}}
		{{/if}}
		<button type="button" class="user user-card-message color-primary-font-color" data-username="{{u.username}}" tabindex="1">{{getName}}{{#if showUsername}} <span class="message-alias border-component-color color-info-font-color">@{{u.username}}</span>{{/if}}</button>
		<span class="info border-component-color color-info-font-color">
			{{#if isBot}}
				<span class="is-bot background-info-font-color">BOT</span>
			{{/if}}
			<span class="time" title='{{date}} {{time}}'>{{time}}</span>
			{{#if showTranslated}}
				<span class="translated">
					<i class="icon-language {{#if autoTranslateFetching}}loading{{/if}}" aria-label="{{_ "Translated"}}"></i>
				</span>
			{{/if}}
		</span>
		<div class="body color-primary-font-color {{system true}}" dir="auto" data-unread-text="{{_ "Unread_Messages"}}">
			{{{body}}}
			{{#if hasOembed}}
				{{#each urls}}
					{{injectIndex . @index}} {{> oembedBaseWidget}}
				{{/each}}
			{{/if}}
			{{#each attachments}}
				{{injectIndex . @index}} {{> messageAttachment}}
			{{/each}}
		</div>
	</li>
</template>
